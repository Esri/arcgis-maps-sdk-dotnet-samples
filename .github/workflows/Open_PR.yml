name: Sync v.next with main

on:
  push:
    branches:
      - wbohr/sync-branch-test

jobs:
  sync_branches:
    runs-on: ubuntu-latest
    steps:
    
      - name: Checkout code
        uses: actions/checkout@v2
        
      - name: Open PR
        env:
          GITHUB_TOKEN: ${{ secrets.BOT_TOKEN }}
        run: |
            if ! git diff --quiet v.next; then
              gh pr create \
                --title "GitHub Action test" \
                --body "This PR confirms that the action is working. This PR should be closed." \
                --head "wbohr/sync-branch-test" \
                --base "main"
              echo "Diff detected, pull request opened."
            else
              echo "No diff detected."
            fi
            