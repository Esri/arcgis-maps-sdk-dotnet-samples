<Page x:Class="ArcGISRuntimeSDKDotNet_StoreSamples.Samples.OwnershipBasedEditing"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:ArcGISRuntimeSDKDotNet_StoreSamples.Common"
      xmlns:esri="using:Esri.ArcGISRuntime.Controls"
      xmlns:layers="using:Esri.ArcGISRuntime.Layers"
      xmlns:data="using:Esri.ArcGISRuntime.Data">
    <Page.Resources>
        <local:KeyValueConverter x:Key="KeyValueConverter" />
        <local:ReverseVisibilityConverter x:Key="ReverseVisibilityConverter" />
    </Page.Resources>
    <Grid>
        <esri:MapView x:Name="MyMapView"
                      Unloaded="MyMapView_Unloaded"
                      LayerLoaded="MyMapView_LayerLoaded"
                      MapViewTapped="MyMapView_MapViewTapped">
            <esri:Map>
                <esri:Map.InitialViewpoint>
                    <esri:ViewpointExtent XMin="-10603931.812"
                                          YMin="3384001.576"
                                          XMax="-10595782.642"
                                          YMax="3388315.896"
                                          SpatialReferenceID="102100" />
                </esri:Map.InitialViewpoint>
                <layers:ArcGISTiledMapServiceLayer ServiceUri="http://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer" />
                <layers:FeatureLayer ID="SaveTheBayMarineLayer">
                    <data:ServiceFeatureTable ServiceUri="http://sampleserver6.arcgisonline.com/arcgis/rest/services/SaveTheBay/FeatureServer/0"
                                              Mode="OnDemand" />
                </layers:FeatureLayer>
            </esri:Map>
        </esri:MapView>
    </Grid>
    <Page.BottomAppBar>
        <CommandBar IsOpen="True"
                    IsSticky="True">
            <CommandBar.PrimaryCommands>
                <AppBarButton x:Name="AddButton"
                              IsEnabled="False"
                              Icon="Add"
                              Label="Add"
                              Click="AddButton_Click"
                              ToolTipService.ToolTip="First Aid Station">
                    <AppBarButton.Tag>
                        <x:Int32>9</x:Int32>
                    </AppBarButton.Tag>
                </AppBarButton>
                <AppBarButton Icon="Save"
                              IsEnabled="False"
                              x:Name="SaveButton"
                              Label="Save"
                              Click="SaveButton_Click" />
                <AppBarButton Icon="Cancel"
                              IsEnabled="{Binding ElementName=SaveButton, Path=IsEnabled}"
                              Label="Cancel"
                              Click="CancelButton_Click" />
            </CommandBar.PrimaryCommands>
            <CommandBar.SecondaryCommands>
                <AppBarButton Icon="Important"
                              Label="Info">
                    <AppBarButton.Flyout>
                        <Flyout>
                            <TextBlock Text="Click on a feature in the map to view the attributes in the data form.  Edit values in the data form and click Apply to save to the database."
                                       Width="200"
                                       TextAlignment="Left"
                                       Margin="30,20,20,30"
                                       TextWrapping="Wrap" />
                        </Flyout>
                    </AppBarButton.Flyout>
                </AppBarButton>
                <AppBarButton Icon="Permissions"
                              Label="Identity"
                              x:Name="Identity"
                              IsEnabled="{Binding ElementName=AddButton, Path=IsEnabled}">
                    <AppBarButton.Flyout>
                        <Flyout>
                            <Grid>
                                <Grid x:Name="LoginPanel" Visibility="Visible">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100" />
                                        <ColumnDefinition Width="150" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Row="0"
                                               Grid.Column="0"
                                               Grid.ColumnSpan="2"
                                               Margin="0,0,0,8"
                                               TextWrapping="Wrap"
                                               x:Name="LoginInfo" />
                                    <TextBlock Grid.Row="1"
                                               Grid.Column="0"
                                               Margin="2"
                                               VerticalAlignment="Center"
                                               Text="Username" />
                                    <TextBox Grid.Row="1"
                                             Grid.Column="1"
                                             Margin="2"
                                             x:Name="Username" />
                                    <TextBlock Grid.Row="2"
                                               Grid.Column="0"
                                               Margin="2"
                                               VerticalAlignment="Center"
                                               Text="Password" />
                                    <!-- Yes, the password is visible in this example. Use a PasswordBox to mask the password text. -->
                                    <TextBox Grid.Row="2"
                                             Grid.Column="1"
                                             Margin="2"
                                             x:Name="Password" />
                                    <Button Grid.Row="3"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2"
                                            Margin="0,12,0,0"
                                            HorizontalAlignment="Center"
                                            Content="Login and Load Layer"
                                            TabIndex="0"
                                            Click="SignInButton_Click" />
                                    <TextBlock Grid.Row="4"
                                               Grid.Column="0"
                                               Grid.ColumnSpan="2"
                                               Margin="8,12,8,0"
                                               Foreground="Red"
                                               TextWrapping="Wrap"
                                               x:Name="ErrorMessage" />
                                </Grid>
                                <Grid Visibility="{Binding ElementName=LoginPanel, Path=Visibility, Converter={StaticResource ReverseVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="100" />
                                    <ColumnDefinition Width="150" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0"
                                           Grid.ColumnSpan="2"
                                           x:Name="DisplayName"/>
                                <TextBlock Text="Logged in as:"
                                           Grid.Column="0"
                                           Grid.Row="1"
                                           Margin="2"
                                           VerticalAlignment="Center" />
                                <TextBlock x:Name="UserName"
                                           FontWeight="Bold"
                                           Margin="2"
                                           Grid.Column="1"
                                           Grid.Row="1"
                                           TextAlignment="Left" />
                                <Button Content="Sign Out"
                                        Grid.Row="2"
                                        Grid.ColumnSpan="2"
                                        Margin="2"
                                        Click="SignOutButton_Click" />
                                </Grid>
                            </Grid>
                        </Flyout>
                    </AppBarButton.Flyout>
                </AppBarButton>
            </CommandBar.SecondaryCommands>
        </CommandBar>
    </Page.BottomAppBar>
</Page>
